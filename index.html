<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<script src='https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js'></script>
<title> Gasoline prices 2021 conversion from 1950 </title>
<center><h1> Gasoline price trend from 1950 reflecting inflation in 2021 </h1></center>
<meta charset='utf-8'>
<style> rect {fill: red; stroke: blue;} </style>
<body>

<button type="button" onclick="func1()">Price</button>
<button type="button" onclick="func2()">Inflation adjuster</button>
<button type="button" onclick="func3()">Price(reflection X)</button>

<svg width = 1000 height = 1000>
</svg>
<script>
      // annotation reference : https://d3-graph-gallery.com/graph/custom_annotation.html
      // source URL : https://afdc.energy.gov/data/10641

      

async function func1() {
            d3.selectAll("svg > *").remove()
            data = await d3.csv("gasoline_prices_conversion_2021.csv")
            var x = d3.scaleLinear().domain([1950,2021]).range([0,850])
            var y = d3.scaleLinear().domain([0,5]).range([400,0])
            var svg1 = d3.select('svg').append('g').attr('transform', 'translate(100,100)')
            var svg2 = d3.select('svg').append('g').attr('transform', 'translate(100,500)')
            var svg3 = d3.select('svg').append('g').attr('transform', 'translate(100,100)')

            // X axis
            svg2.call(d3.axisBottom(x).tickValues([1950,1955,1960,1965,1970,1975,1980,1985,1990,1995,2000,2005,2010,2015,2021]).tickFormat(d3.format('.0f')))
            d3.select('svg').append('text').attr('x', 290).attr('y', 540).text('year')
      
            // Y axis
            svg3.call(d3.axisLeft(y).tickValues([0,1,3,5]).tickFormat(d3.format('.2f')))
            d3.select('svg').append('text').attr('x', 20).attr('y', 270).text('price or ia')
            // format reference : https://observablehq.com/@d3/d3-format
      
            svg1.selectAll('rect').data(data).enter().append('rect').attr('width', 4).attr('height', 4).attr('x', function(d) { return x(d['Year']);}).attr('y', function(d) { return y(d['Gasoline Price (2021 $/gallon)' ]);})
            
            // annotation
            const annotation1 = [
                  {
                        note: {
                              label: "1950~2021 Gasoline price reflecting inflation(2021 price)",
                              title: "$/gallon"
                              },
                        x: 550,
                        y: 220,
                        dy: -50,
                        dx: 50
                  }
                  ]
      
            const makeAnnotation1 = d3.annotation().annotations(annotation1)
      
            d3.select('svg').append('g').call(makeAnnotation1)
}

async function func2() {
            d3.selectAll("svg > *").remove()
            data = await d3.csv("gasoline_prices_conversion_2021.csv")
            var x = d3.scaleLinear().domain([1950,2021]).range([0,850])
            var y = d3.scaleLinear().domain([0,5]).range([400,0])
            var svg1 = d3.select('svg').append('g').attr('transform', 'translate(100,100)')
            var svg2 = d3.select('svg').append('g').attr('transform', 'translate(100,500)')
            var svg3 = d3.select('svg').append('g').attr('transform', 'translate(100,100)')

            // X axis
            svg2.call(d3.axisBottom(x).tickValues([1950,1955,1960,1965,1970,1975,1980,1985,1990,1995,2000,2005,2010,2015,2021]).tickFormat(d3.format('.0f')))
            d3.select('svg').append('text').attr('x', 290).attr('y', 540).text('year')
      
            // Y axis
            svg3.call(d3.axisLeft(y).tickValues([0,1,3,5]).tickFormat(d3.format('.2f')))
            d3.select('svg').append('text').attr('x', 20).attr('y', 270).text('price or ia')
            // format reference : https://observablehq.com/@d3/d3-format
 
      
            svg1.selectAll('rect').data(data).enter().append('rect').attr('width', 4).attr('height', 4).attr('x', function(d) { return x(d['Year']);}).attr('y', function(d) { return y(d['Inflation Adjuster']);})
            
            // annotation
            const annotation2 = [
                  {
                        note: {
                              label: "1950~2021 Inflation adjuster reflecting prices of 2021 : The higher the number for the year, the lower the price (continuous rise)",
                              title: "Inflation transition"
                              },
                        x: 550,
                        y: 220,
                        dy: -50,
                        dx: 50
                  }
                  ]
      
            const makeAnnotation2 = d3.annotation().annotations(annotation2)
      
            d3.select('svg').append('g').call(makeAnnotation2)
}
      
async function func3() {
            d3.selectAll("svg > *").remove()
            data = await d3.csv("gasoline_prices_conversion_2021.csv")
            var x = d3.scaleLinear().domain([1950,2021]).range([0,850])
            var y = d3.scaleLinear().domain([0,5]).range([400,0])
            var svg1 = d3.select('svg').append('g').attr('transform', 'translate(100,100)')
            var svg2 = d3.select('svg').append('g').attr('transform', 'translate(100,500)')
            var svg3 = d3.select('svg').append('g').attr('transform', 'translate(100,100)')

            // X axis
            svg2.call(d3.axisBottom(x).tickValues([1950,1955,1960,1965,1970,1975,1980,1985,1990,1995,2000,2005,2010,2015,2021]).tickFormat(d3.format('.0f')))
            d3.select('svg').append('text').attr('x', 290).attr('y', 540).text('year')
      
            // Y axis
            svg3.call(d3.axisLeft(y).tickValues([0,1,3,5]).tickFormat(d3.format('.2f')))
            d3.select('svg').append('text').attr('x', 20).attr('y', 270).text('price or ia')
            // format reference : https://observablehq.com/@d3/d3-format
 
      
            svg1.selectAll('rect').data(data).enter().append('rect').attr('width', 4).attr('height', 4).attr('x', function(d) { return x(d['Year']);}).attr('y', function(d) { return y(d['Gasoline Price ($/gallon)']);})
            
            // annotation
            const annotation3 = [
                  {
                        note: {
                              label: "1950~2021 Gasoline price (without reflecting inflation)",
                              title: "$/gallon"
                              },
                        x: 550,
                        y: 220,
                        dy: -50,
                        dx: 50
                  }
                  ]
      
            const makeAnnotation3 = d3.annotation().annotations(annotation3)
      
            d3.select('svg').append('g').call(makeAnnotation3)
}

          
//Backup      
//svg1.selectAll('rect').data(data).enter().append('rect').attr('width', 4).attr('height', 4).attr('x', function(d) { return x(d['Year']);}).attr('y', function(d) { return y(d['Gasoline Price (2021 $/gallon)']);})

</script>
</body>
</html>
